<section class="catalog">
  <h1>Catálogo</h1>

  <input
    aria-label="Buscar produtos"
    [formControl]="search"
    placeholder="Buscar por nome..."
  />

  <div *ngIf="loading">Carregando…</div>

  <ul class="grid cards" *ngIf="products.length; else noResults">
    <li
      *ngFor="let p of products"
      class="card"
      [class.inactive]="!p.active || available(p) === 0"
    >
      <figure class="thumb">
        <img [src]="imgFor(p)" [alt]="p.name" loading="lazy" />
      </figure>

      <div class="body">
        <h3 class="title">{{ p.name }}</h3>
        <p class="meta">
          <span class="price">{{ p.price | currency : "BRL" }}</span>
          <span class="stock">Estoque: {{ available(p) }}</span>
        </p>
      </div>

      <div class="actions">
        <button
          (click)="add(p)"
          [disabled]="!p.active || available(p) === 0"
          aria-label="Adicionar {{ p.name }} ao carrinho"
        >
          {{ available(p) === 0 ? "Esgotado" : "Adicionar" }}
        </button>
      </div>
    </li>
  </ul>

  <ng-template #noResults>
    <p>Nenhum produto encontrado.</p>
  </ng-template>

  <nav class="pager" role="navigation" aria-label="Paginação">
    <button (click)="onPageChange(page - 1)" [disabled]="page === 0">
      Anterior
    </button>
    <span>
      Página {{ page + 1 }} de
      {{ (total + size - 1) / size | number : "1.0-0" }}
    </span>
    <button
      (click)="onPageChange(page + 1)"
      [disabled]="(page + 1) * size >= total"
    >
      Próxima
    </button>
  </nav>
</section>
<app-cart></app-cart>
